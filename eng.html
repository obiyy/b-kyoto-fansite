<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>YouTube字幕学習</title>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    #subtitleBox { margin-top: 30px; }
    .line { margin-bottom: 20px; }
  </style>
</head>
<body>
  <h1>YouTube字幕で英語学習</h1>
  <input type="text" id="youtubeUrl" placeholder="YouTubeのURLを入力" size="60">
  <button onclick="fetchSubtitles()">字幕取得</button>

  <div id="subtitleBox"></div>

  <script>
    let subtitles = [];
    let index = 0;

    async function fetchSubtitles() {
      const url = document.getElementById('youtubeUrl').value;

      const res = await fetch('https://movie-transcript.onrender.com/get_subtitles', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ url })
      });

      const data = await res.json();
      if (data.error) {
        alert("エラー：" + data.error);
        return;
      }

      subtitles = data;
      index = 0;
      showNext();
    }

    function showNext() {
      const box = document.getElementById('subtitleBox');
      box.innerHTML = ''; // clear

      if (index < subtitles.length) {
        const line = subtitles[index];
        box.innerHTML = `
          <div class="line">
            <strong>英語:</strong> ${line.en}<br>
            <strong>日本語:</strong> ${line.ja}<br><br>
            <button onclick="showNext()">次へ</button>
          </div>
        `;
        index++;
      } else {
        box.innerHTML = '<p>学習完了！</p>';
      }
    }
  </script>
</body>
</html>
